<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Log in · {{ SITE_NAME }}</title>

  <!-- Modern UI font -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <meta http-equiv="refresh" content="{{ 60 * SETTING.get('session_timeout') }}">
  <link rel="icon" href="{{ url_for('static', filename='img/favicon.png') }}">

  {% assets "css_login" -%}
    <link rel="stylesheet" href="{{ ASSET_URL }}">
  {%- endassets %}

  <style>
    :root{
      --bg-1: #071120;
      --bg-2: #081428;
      --glass-border: rgba(255,255,255,0.04);
      --muted: rgba(255,255,255,0.68);
      --accent-from: #5eead4;
      --accent-to:   #60a5fa;
      --radius: 14px;
      color-scheme: dark;
    }

    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;background: radial-gradient(800px 400px at 10% 10%, rgba(96,165,250,0.03), transparent), linear-gradient(180deg,var(--bg-1),var(--bg-2));}

    .page{min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:32px 20px;gap:18px}

    /* top header logo outside card */
    .site-header{display:flex;align-items:center;justify-content:center;padding:6px}
    .site-header img{height:72px;object-fit:contain}

    .card{
      width:100%;max-width:560px;padding:32px;border-radius:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid var(--glass-border);box-shadow:0 10px 50px rgba(2,6,23,0.6);backdrop-filter: blur(8px);
      display:flex;flex-direction:column;gap:16px;align-items:stretch;position:relative;overflow:hidden
    }

    .brand{display:flex;flex-direction:column;align-items:center;gap:6px;margin-bottom:4px}
    .brand .title{font-weight:700;font-size:20px;color:whitesmoke;letter-spacing:0.2px}
    .brand .subtitle{font-size:15px;color:var(--muted);margin-top:2px}

    form{display:block}
    .field{margin-bottom:12px}
    .input{width:100%;padding:14px 16px;border-radius:12px;border:1px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);color:#fff;font-size:15px;outline:none;box-sizing:border-box}
    .input::placeholder{color:rgba(255,255,255,0.48)}

    .row{display:flex;gap:12px;align-items:center}
    .row .left{flex:0 0 auto}
    .row .right{flex:1 1 auto;display:flex;justify-content:flex-end}

    .remember{display:flex;align-items:center;gap:10px;color:var(--muted);font-weight:600}
    .remember input{width:18px;height:18px;appearance:none;border-radius:4px;border:1px solid rgba(255,255,255,0.12);background:transparent;display:inline-block}
    .remember input:checked{background:linear-gradient(90deg,var(--accent-from),var(--accent-to));border:0}

    .btn{padding:12px 20px;border-radius:12px;border:0;font-weight:700;cursor:pointer}
    .btn-primary{background:linear-gradient(90deg,var(--accent-from),var(--accent-to));color:#042027;box-shadow:0 8px 24px rgba(96,165,250,0.12)}
    .cta{min-width:220px}

    .helper{font-size:14px;color:var(--muted);text-align:center;margin-top:6px}
    .helper a{color:var(--accent-to);text-decoration:none;font-weight:600}

    .footer{text-align:center;color:rgba(255,255,255,0.6);font-size:13px;margin-top:6px}
    .footer a{color:rgba(96,165,250,0.95)}

    @media (max-width:520px){
      .card{padding:20px;border-radius:12px}
      .site-header img{height:56px}
      .row{flex-direction:column;align-items:stretch}
      .row .right{justify-content:stretch}
      .cta{width:100%}
    }

    .input:focus{box-shadow:0 0 0 4px rgba(96,165,250,0.06);border-color:rgba(96,165,250,0.4)}
    .btn-primary:focus{outline:3px solid rgba(96,165,250,0.12)}
    .alert{padding:10px;border-radius:10px;background:rgba(255,60,60,0.06);border:1px solid rgba(255,60,60,0.12);color:#ffb4b4;font-weight:600}
  </style>
</head>
<body>
  <div class="page">

    {# Top logo outside the card. Falls back to static/img/logo.png if not configured #}
    <header class="site-header" role="banner">
      {% set header_logo = SETTING.get('site_logo') if SETTING.get('site_logo') else 'logo.png' %}
      {% if header_logo.startswith('http') %}
        <a href="/" aria-label="Home"><img src="{{ header_logo }}" alt="{{ SITE_NAME }} logo"></a>
      {% else %}
        <a href="/" aria-label="Home"><img src="{{ url_for('static', filename='img/' ~ header_logo) }}" alt="{{ SITE_NAME }} logo"></a>
      {% endif %}
    </header>

    <main class="card" role="main" aria-labelledby="login-title">

      <div class="brand">
        <div class="title">{{ SETTING.get('site_name') or SITE_NAME }}</div>
        <div class="subtitle">Sign in to continue</div>
      </div>

      {% if error %}
        <div class="alert" role="alert">{{ error }}</div>
      {% endif %}

      {% if SETTING.get('ldap_enabled') or SETTING.get('local_db_enabled') %}
      <form action="" method="post" novalidate>
        <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">

        <div class="field">
          <label for="username" class="sr-only">Username</label>
          <input id="username" name="username" type="text" class="input" placeholder="Username" required autofocus {% if username %}value="{{ username }}"{% endif %} aria-label="Username">
        </div>

        <div class="field">
          <label for="password" class="sr-only">Password</label>
          <input id="password" name="password" type="password" class="input" placeholder="Password" required {% if password %}value="{{ password }}"{% endif %} aria-label="Password">
        </div>

        {% if SETTING.get('otp_field_enabled') %}
        <div class="field">
          <input name="otptoken" type="text" class="input" placeholder="OTP token (if enabled)" autocomplete="off" aria-label="OTP Token">
        </div>
        {% endif %}

        {% if SETTING.get('ldap_enabled') and SETTING.get('local_db_enabled') %}
        <div class="field">
          <select class="input" name="auth_method" aria-label="Authentication method">
            <option value="LOCAL">Local Authentication</option>
            <option value="LDAP" {% if SETTING.get('login_ldap_first') %}selected{% endif %}>LDAP Authentication</option>
          </select>
        </div>
        {% elif SETTING.get('ldap_enabled') and not SETTING.get('local_db_enabled') %}
          <input type="hidden" name="auth_method" value="LDAP">
        {% else %}
          <input type="hidden" name="auth_method" value="LOCAL">
        {% endif %}

        <div class="row" style="margin-top:6px">
          <div class="left">
            <label class="remember"><input type="checkbox" name="remember" id="remember"> Remember me</label>
          </div>

          <div class="right">
            <button type="submit" class="btn btn-primary cta" aria-label="Sign in">Sign In</button>
          </div>
        </div>

      </form>
      {% endif %}

      {% if SETTING.get('google_oauth_enabled') or SETTING.get('github_oauth_enabled') or SETTING.get('oidc_oauth_enabled') or SETTING.get('azure_oauth_enabled') %}
      <div style="margin-top:6px">
        {% if SETTING.get('ldap_enabled') or SETTING.get('local_db_enabled') %}
          <div class="helper">— OR —</div>
        {% endif %}

        <div style="display:flex;flex-direction:column;gap:8px;margin-top:12px">
          {% if SETTING.get('oidc_oauth_enabled') %}
            <a href="{{ url_for('index.oidc_login') }}" class="btn" style="border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--muted);padding:10px;border-radius:10px;text-decoration:none;text-align:center;">Sign in with OpenID Connect</a>
          {% endif %}
          {% if SETTING.get('github_oauth_enabled') %}
            <a href="{{ url_for('index.github_login') }}" class="btn" style="border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--muted);padding:10px;border-radius:10px;text-decoration:none;text-align:center;">Sign in with GitHub</a>
          {% endif %}
          {% if SETTING.get('google_oauth_enabled') %}
            <a href="{{ url_for('index.google_login') }}" class="btn" style="border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--muted);padding:10px;border-radius:10px;text-decoration:none;text-align:center;">Sign in with Google</a>
          {% endif %}
          {% if SETTING.get('azure_oauth_enabled') %}
            <a href="{{ url_for('index.azure_login') }}" class="btn" style="border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--muted);padding:10px;border-radius:10px;text-decoration:none;text-align:center;">Sign in with Microsoft</a>
          {% endif %}
        </div>
      </div>
      {% endif %}

      {% if saml_enabled %}
        <div style="text-align:center"><a href="{{ url_for('index.saml_login') }}" style="color:var(--accent-to);text-decoration:none;font-weight:600">SAML login</a></div>
      {% endif %}

      {% if SETTING.get('signup_enabled') %}
        <div class="helper">No account? <a href="{{ url_for('index.register') }}">Create an account</a></div>
      {% endif %}

      <div class="footer">Powered by <a href="https://github.com/alsyundawy/PowerDNS-Admin" target="_blank" rel="noopener noreferrer">PowerDNS-Admin</a> <span aria-hidden="true" style="opacity:0.6;margin:0 8px">|</span> Modified by <a href="https://alsyundawy.com" target="_blank" rel="noopener noreferrer">ALSYUNDAWY IT SOLUTION</a></div>

    </main>
  </div>

  {% assets "js_login" -%}
    <script type="text/javascript" src="{{ ASSET_URL }}"></script>
  {%- endassets %}

  <script>
    (function(){
      var u = document.getElementById('username'); if(u) try{u.focus();u.select()}catch(e){}
    })();
  </script>
</body>
</html>